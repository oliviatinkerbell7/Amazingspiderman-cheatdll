name: Build dinput8.dll (Windows)

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest

    steps:
      # 1️⃣ Checkout code
      - name: Checkout repository
        uses: actions/checkout@v5

      # 2️⃣ Setup Visual Studio Build Tools
      - name: Setup Visual Studio environment
        uses: microsoft/setup-msbuild@v1
        with:
          vs-version: 'latest'

      # 3️⃣ Compile the DLL
      - name: Compile DLL
        shell: cmd
        run: |
          echo Compiling dinput8.dll...
          call "C:\Program Files (x86)\Microsoft Visual Studio\2022\BuildTools\VC\Auxiliary\Build\vcvarsall.bat" x86
          cl /LD src\main.cpp /Fe:dinput8.dll /MD /EHsc /Zi
          dir dinput8.dll

      # 4️⃣ Upload DLL artifact
      - name: Upload compiled DLL
        uses: actions/upload-artifact@v4
        with:
          name: dinput8-dll
          path: dinput8.dll          name: dinput8-dll
          path: dinput8.dll        with:
          name: dinput8-dll
          path: dinput8.dll
